import { MockProvider } from './MockProvider';
export const loadFixture = createFixtureLoader();
export function createFixtureLoader(overrideSigners, overrideProvider) {
    const snapshots = [];
    return async function load(fixture) {
        const snapshot = snapshots.find((snapshot) => snapshot.fixture === fixture);
        if (snapshot) {
            await snapshot.provider.send('evm_revert', [snapshot.id]);
            snapshot.id = await snapshot.provider.send('evm_snapshot', []);
            return snapshot.data;
        }
        else {
            const provider = overrideProvider !== null && overrideProvider !== void 0 ? overrideProvider : new MockProvider();
            const signers = overrideSigners !== null && overrideSigners !== void 0 ? overrideSigners : provider.getWallets();
            const data = await fixture(signers, provider);
            const id = await provider.send('evm_snapshot', []);
            snapshots.push({ fixture, data, id, provider, signers });
            return data;
        }
    };
}
